# 智能日程助手环境配置指南

## 1. 环境准备

### 1.1 安装 Git

1. 访问 [Git 官方网站](https://git-scm.com/downloads)
2. 下载并安装适合您操作系统的 Git 版本
3. 安装时使用默认配置即可
4. 验证安装：
   ```bash
   git --version
   ```

### 1.2 安装 Python

1. 访问 [Python 官方网站](https://www.python.org/downloads/)
2. 下载并安装 Python 3.8 或更高版本
3. 安装时勾选 "Add Python to PATH"
4. 验证安装：
   ```bash
   python --version
   pip --version
   ```

### 1.3 安装 Node.js

1. 访问 [Node.js 官方网站](https://nodejs.org/)
2. 下载并安装 Node.js 16 或更高版本（推荐 LTS 版本）
3. 验证安装：
   ```bash
   node --version
   npm --version
   ```

## 2. 项目克隆

1. 克隆项目代码：
   ```bash
   git clone https://github.com/your-repo/intelligent-calendar-for-BUAAer.git
   cd intelligent-calendar-for-BUAAer
   ```

## 3. 后端配置与启动

### 3.1 安装后端依赖

1. 进入后端目录：
   ```bash
   cd backend
   ```

2. 创建虚拟环境（可选但推荐）：
   ```bash
   # Windows
   python -m venv venv
   venv\Scripts\activate
   
   # macOS/Linux
   python3 -m venv venv
   source venv/bin/activate
   ```

3. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

### 3.2 配置环境变量

**配置API_KEY的两种方式**：

**方式一：通过前端设置界面配置（推荐）**
1. 按照后续步骤启动后端和前端服务
2. 打开前端页面 `http://localhost:5173`
3. 点击右上角的"设置"按钮
4. 在"API_KEY配置"部分输入您的API Key
5. 点击"保存API Key"，系统会自动将API Key保存到后端的 `.env` 文件中

**方式二：手动配置 `.env` 文件**
1. 在后端目录创建 `.env` 文件：
   ```bash
   touch .env
   ```

2. 编辑 `.env` 文件，添加以下内容：
   ```env
   # Flask 密钥，用于会话管理和加密
   SECRET_KEY=your-secret-key-here
   
   # 大语言模型 API 密钥
   LLM_API_KEY=your-llm-api-key-here
   
   # 大语言模型 API URL（可选，默认使用 Qwen API）
   # LLM_API_URL=https://api.qwen.com/v1/chat/completions
   
   # 数据库 URL（可选，默认使用 SQLite）
   # DATABASE_URL=sqlite:///app.db
   ```

   **注意**：
   - `SECRET_KEY` 可以是任意随机字符串，用于 Flask 应用的安全
   - `LLM_API_KEY` 需要从相应的大语言模型服务提供商处获取
   - 阿里云百炼API_KEY获取方法：[开通服务后创建获取APIKey](https://help.aliyun.com/zh/model-studio/get-api-key)
   - 确保API_KEY的归属业务空间有调用相应模型的权限

### 3.3 启动后端服务

1. 启动后端应用：
   ```bash
   python app.py
   ```

2. 验证后端服务是否正常运行：
   - 打开浏览器访问 `http://localhost:5000`
   - 应该看到 Flask 的默认页面或 API 响应

## 4. 前端配置与启动

### 4.1 安装前端依赖

1. 返回项目根目录，进入前端目录：
   ```bash
   cd ../frontend
   ```

2. 安装前端依赖：
   ```bash
   npm install
   ```

### 4.2 配置前端 API 地址

1. 编辑前端 API 配置文件（如果需要）：
   - 前端 API 配置位于 `src/services/api.js`
   - 默认 API 地址为 `http://localhost:5000/api`
   - 如果后端服务运行在不同地址或端口，需要修改此配置

### 4.3 启动前端开发服务器

1. 启动前端开发服务器：
   ```bash
   npm run dev
   ```

2. 验证前端服务是否正常运行：
   - 打开浏览器访问终端输出中显示的地址（通常是 `http://localhost:5173`）
   - 应该看到智能日程助手的登录页面

## 5. 项目使用

### 5.1 首次使用

1. 打开前端页面 `http://localhost:5173`
2. 点击 "设置" 或 "绑定北航账号"
3. 输入北航学号和密码，点击 "绑定"
4. 系统会自动获取课程表并导入到日历中
5. 开始使用智能日程助手

### 5.2 主要功能

- **课程表自动同步**：绑定北航账号后自动获取课程信息
- **智能任务创建**：支持文本输入、图片上传，自动解析任务信息
- **任务管理**：查看、编辑、完成任务
- **日历视图**：以日历形式查看所有日程
- **提醒设置**：为不同类型任务配置提醒时间

## 6. 常见问题与解决方案

### 6.1 后端启动失败

**问题**：`ModuleNotFoundError: No module named 'flask'`
**解决方案**：确保已激活虚拟环境并安装了所有依赖

**问题**：`KeyError: 'SECRET_KEY'`
**解决方案**：确保已创建 `.env` 文件并添加了 `SECRET_KEY` 配置

### 6.2 前端启动失败

**问题**：`npm ERR! code ENOENT`
**解决方案**：确保已进入前端目录并正确安装了依赖

**问题**：`Error: Cannot find module 'vue'`
**解决方案**：运行 `npm install` 重新安装依赖

### 6.3 API 调用失败

**问题**：前端无法连接到后端 API
**解决方案**：
1. 确保后端服务正在运行
2. 检查前端 API 配置是否正确
3. 检查浏览器控制台的网络请求，确认请求地址是否正确

### 6.4 北航账号绑定失败

**问题**：绑定北航账号时提示 "登录失败"
**解决方案**：
1. 检查学号和密码是否正确
2. 确保网络环境可以访问北航官方 API
3. 查看后端日志，获取详细错误信息

## 7. 开发说明

### 7.1 后端开发

- 后端使用 Flask 框架，代码结构清晰
- 主要模块：
  - `app.py`：应用入口
  - `config.py`：配置管理
  - `models/`：数据模型
  - `routes/`：API 路由
  - `services/`：业务逻辑
  - `utils/`：工具函数

### 7.2 前端开发

- 前端使用 Vue 3 + Vite 框架
- 主要模块：
  - `src/components/`：Vue 组件
  - `src/services/`：API 服务
  - `src/store/`：状态管理
  - `src/views/`：页面视图

### 7.3 数据库管理

- 默认使用 SQLite 数据库，数据文件为 `instance/app.db`
- 如需使用其他数据库（如 MySQL、PostgreSQL），修改 `.env` 文件中的 `DATABASE_URL` 配置

## 8. 部署说明

### 8.1 后端部署

1. 安装 Gunicorn：
   ```bash
   pip install gunicorn
   ```

2. 使用 Gunicorn 启动后端：
   ```bash
   gunicorn -w 4 -b 0.0.0.0:5000 app:create_app()
   ```

### 8.2 前端部署

1. 构建前端生产版本：
   ```bash
   npm run build
   ```

2. 将 `dist/` 目录下的文件部署到 Web 服务器（如 Nginx、Apache）
